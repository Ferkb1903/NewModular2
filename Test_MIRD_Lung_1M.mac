########################################
# Test MIRD Lung Material - 1M eventos
# Heterogeneidad en Lung (MIRD)
########################################

/control/verbose 1
/run/verbose 1
/event/verbose 0
/tracking/verbose 0

# Inicialización
/run/initialize

# Seleccionar fuente (Iodine I-125 seed)
/source/switch Iodine

# Configurar fuente de I125
/gps/particle ion
/gps/ion 53 125 0 0
/gps/energy 0. keV

# Posición de la fuente (centrada)
/gps/pos/type Point
/gps/pos/centre 0. 0. 0. mm

# Dirección isotrópica
/gps/ang/type iso

# Configuración del fantoma
# Fantoma de agua con heterogeneidad de lung (MIRD material)

# Material base: agua
/phantom/setMaterial G4_WATER

# Heterogeneidad: MIRD lung (ρ=0.2958 g/cm³)
/heterogeneity/enable true
/heterogeneity/material G4_LUNG_MIRD
/heterogeneity/size 60. 60. 60. mm
/heterogeneity/position 40. 0. 0. mm

# Análisis
/analysis/setFileName brachytherapy_mird_lung_hetero1m
/analysis/setFileNamePrimary brachytherapy_eDepPrimary_mird_lung_hetero1m
/analysis/setFileNameSecondary brachytherapy_eDepSecondary_mird_lung_hetero1m

# Ejecutar simulación
/run/beamOn 1000000

# Resultado esperado:
# - brachytherapy_eDepPrimary_mird_lung_hetero1m.root
# - brachytherapy_eDepSecondary_mird_lung_hetero1m.root
# - brachytherapy_mird_lung_hetero1m.root
